@model InfoInfo2025.Models.ViewModels.TextWithOpinions
@using System.Security.Claims;

@{
    ViewData["Title"] = @Model.SelectedText.Title;
}

<article>
    <h1 class="text-primary text-center">@Model.SelectedText.Title</h1>
    <div class="row">
        <section class="col-lg-3 mt-3">
            @if (Model.SelectedText.Author.Photo != null)
            {
                <div class="d-none d-lg-block">
                    <img src="~/photo/mini/@Model.SelectedText.Author.Photo" width="150" alt="Autor tekstu" class="rounded-circle ms-3 mb-3">
                </div>
            }
            <div class="row textDisplay ">
                <!--imię i nazwisko autora oraz data dodania-->
                <div class="col-6 col-lg-12">
                    <p><i class="bi bi-person-circle me-1" title="Autor"></i><span class="text-success fw-bold">@Model.SelectedText.Author.FullName</span></p>
                    <p><i class="bi bi-calendar-event me-1" title="Data dodania"></i>@Model.SelectedText.AddedDate.ToString("dd MMMM yyyy")</p>
                    <p><i class="bi bi-folder2-open me-1" title="Kategoria"></i>@Model.SelectedText.Category.Name</p>
                </div>
                <!--liczba komentarzy oraz ocena tekstu-->
                <div class="col-6 col-lg-12">
                    <p><i class="bi bi-smartwatch me-1" title="Czas"></i>Czas czytania ok. @Model.ReadingTime min</p>
                    <p><i class="bi bi-chat-square-text me-1" title="Liczba komenatrzy"></i>@Model.CommentsCount @Model.Description</p>
                    <p><i class="bi bi-trophy me-1" title="Ocena"></i>Ocena: @Model.AverageRating z @Model.RatingsCount</p>
                </div>
            </div>
            @{
                string[] tags = @Model.SelectedText.Keywords.Split(',');
                foreach (var tag in tags)
                {
                    <p class="d-inline d-lg-block mb-1"><span class="badge bg-primary">@tag</span></p>
                }
            }
        </section>

        <!-- obrazek, streszczenie i treść tekstu -->
        <section class="col-lg-9">
            @{
                if (!String.IsNullOrEmpty(Model.SelectedText.Graphic))
                {
                    <img class="img-fluid mt-3" src="~/img/@Model.SelectedText.Graphic">
                }
                else
                {
                    <hr />
                }
            }

            <div class="col-10 offset-1 my-3">
                <h2 class="lead fst-italic">@Model.SelectedText.Summary</h2>
            </div>

            <hr />
            @Html.Raw(Model.SelectedText.Content)
            <hr />
        </section>
    </div>
</article>
<div class="col-lg-9 offset-lg-3">
    <section class="mb-3">
        <a asp-action="Index" class="btn btn-primary">Lista tekstów</a>
        @if (User.FindFirstValue(ClaimTypes.NameIdentifier) == Model.SelectedText.UserId)
        {
            <a asp-action="Edit" asp-route-id="@Model.SelectedText.TextId" class="btn btn-warning">Edycja tekstu</a>
        }
    </section>
</div>
